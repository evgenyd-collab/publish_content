## План изменений для страницы рейтингов (Odds)

### Контекст
- Бэкенд обновил набор GET-эндпойнтов в пространстве `odds`.
- Фронт должен перейти на новые эндпойнты, упростить маппинг данных и делегировать сортировку/агрегации серверу.

### Эндпойнты и ожидания
- **Locales — GET `/api/v1/odds/locales`**
  - Возвращает только локали, для которых есть данные рейтингов (уже отфильтровано на сервере).
  - Формат: массив объектов `{ id, locale_code }`.
  - На фронте: перейти с `/locales/` на `/odds/locales`; убрать клиентскую проверку/фильтрацию по наличию рейтингов.

- **Sports — GET `/api/v1/odds/sports?locale_id=…`**
  - Возвращает массив строк (имена видов спорта), включая синтетический элемент `"average"` в начале.
  - На фронте: не добавлять вручную `"average"` (его вернёт сервер); маппинг строк → объекты сегментов `{ value: slug(name), label: pretty(name), apiValue: name }`.

- **Championships — GET `/api/v1/odds/championships`**
  - Всегда запрашиваем с `with_counts=true` (чтобы не поддерживать два формата).
  - Обязательные параметры: `locale_id`, `sport` (точное имя из `/sports`).
  - Опциональные: `limit` (по умолчанию 10; сортировка по популярности уже на сервере).
  - Маппинг на фронте: использовать поля ответа `{ name, matches_count }`.

- **Ratings — GET `/api/v1/odds/ratings`**
  - Сервер возвращает: `scope`, `total`, `summary`, `pagination`, `items` (каждый item уже содержит готовые поля для отображения).
  - `last_updated` — вариативное поле. Если присутствует — показываем, если нет — не отображаем и не ломаемся.
  - Параметры, которые используем сейчас:
    - `locale_id` — обязательно
    - `sport` — строка; по умолчанию `average`
    - `championship` — строка (опционально)
    - `sort_by=rank` и `order=asc` — по умолчанию; сортировка происходит на сервере
    - `limit` и `offset` — для пагинации

### Что меняем на фронте (файл `src/odds/BookmakerRatingsPage.jsx`)
- **Локали**
  - Используем `/odds/locales` (уже «всё ок»), без дополнительной клиентской фильтрации по наличию рейтингов.

- **Виды спорта**
  - Используем `/odds/sports?locale_id=…` (уже «всё ок»); сервер возвращает строки, включая `"average"`.

- **Турниры**
  - Всегда запрашиваем `/odds/championships` с `with_counts=true`.
  - Убираем клиентский `slice(0, 10)` и полагаемся на параметр `limit` запроса (дефолт 10; можно передавать явно).
  - Маппинг: брать `name` и `matches_count` из ответа, формировать элементы селекта из них.

- **Рейтинги**
  - Перестаём сортировать на клиенте. Порядок строк — как пришёл с сервера.
  - По умолчанию запрашиваем с `sort_by=rank&order=asc`.
  - Добавляем полноценную пагинацию через серверные `limit`/`offset` и объект `pagination` из ответа.
  - Обработка `last_updated`: безопасно читаем поле на верхнем уровне ответа или в `summary.last_updated`; если отсутствует — не отображаем.
  - Маппинг `items` упрощаем: используем поля ответа как есть (без локальных перерасчётов рейтинга/средней маржи).

### Пагинация (как на вкладках с бонусами)
- **Параметры**: `limit` (варианты: 10, 20, 50; дефолт — 20), `offset`.
- **UI**: селектор размера страницы (10/20/50) и управление страницами (вперёд/назад) по `pagination.has_prev/has_next`.
- **Состояния**: хранить `limit` и `offset` в состоянии компонента; при изменении любого фильтра/сорта — сбрасывать `offset=0`.
- **Запрос**: каждый переход по страницам/смена размера страницы отправляет новый запрос с актуальными `limit/offset` и фильтрами.

### Что не делаем в этом коммите (будущие задачи)
- **Интерактивная сортировка по колонкам**
  - Делегировать сортировку серверу. Добавить UI-точки входа (клики по заголовкам) и маппинг ключей колонок → `sort_by` API:
    - `rank` → `rank`
    - `rating` → `rating`
    - `avg_margin` → `avg_margin`
    - `winner_margin` → `winner_margin`
    - `ou_margin` → `ou_margin`
    - `matches` (колонка Matches) → `matches`
  - Поддержка `order` (asc/desc). По умолчанию — `rank/asc`.

### Пример запросов
```http
GET /api/v1/odds/locales

GET /api/v1/odds/sports?locale_id=1

GET /api/v1/odds/championships?locale_id=1&sport=football&with_counts=true&limit=10

GET /api/v1/odds/ratings?locale_id=1&sport=average&sort_by=rank&order=asc&limit=20&offset=0
```

### Критерии готовности
- Турниры всегда приходят в формате `{ name, matches_count }` (используем `with_counts=true`).
- В списке видов спорта нет дубликата элемента `average` (не добавляем вручную).
- Рейтинги отображаются без клиентской сортировки, в порядке, который пришёл с сервера.
- Пагинация реализована: выбор размера страницы (10/20/50, дефолт 20), переключатели страниц, корректное чтение `pagination`.
- Отсутствие `last_updated` не ломает страницу; при наличии — отображается.


